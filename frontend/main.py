"""
–ü—Ä–æ–≥—Ä–∞–º–º–∞: –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ EDA, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –º–æ–¥–µ–ª–∏ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
–í–µ—Ä—Å–∏—è: 1.0
"""

import os

import yaml
import streamlit as st
from src.data.get_data import load_data, get_data
from src.plot.charts import (
    bar_plot,
    correlation_plot,
    box_plot,
    line_plot,
    scatter_plot,
)
from src.train.train import train_model
from src.evaluate.evaluate import evaluate_input, evaluate_from_file


CONFIG_PATH = "../config/config.yaml"


def main_page():
    """
    –ù–∞—á–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–µ–∫—Ç–∞
    """
    st.title("MLOps –ø—Ä–æ–µ–∫—Ç: –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–∞—Å—Å–æ–≤—ã—Ö —Å–±–æ—Ä–æ–≤ —Ñ–∏–ª—å–º–∞ üé¨üé•")
    st.write(
        """
        –ó–∞–¥–∞—á–µ–π –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–∞—Å—Å–æ–≤—ã—Ö —Å–±–æ—Ä–æ–≤ —Ñ–∏–ª—å–º–æ–≤. –î–∞–Ω–Ω—ã–µ –±—ã–ª–∏ —Å–æ–±—Ä–∞–Ω—ã —Å —Å–∞–π—Ç–∞ –ö–∏–Ω–æ–ø–æ–∏—Å–∫ 
        —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞. –ë—ã–ª–∏ –≤—ã–±—Ä–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ —Ñ–∏–ª—å–º–∞—Ö –°–®–ê –∑–∞ –≤—Å–µ –≥–æ–¥—ã —Å –ø–µ—Ä–≤—ã—Ö 1000 —Å—Ç—Ä–∞–Ω–∏—Ü 
        —Å–∞–π—Ç–∞ (–Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞—Å—Å–æ–≤—ã—Ö —Å–±–æ—Ä–∞—Ö –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –±—ã–ª–æ)."""
    )
    st.markdown(
        """
        ### –û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–µ–π 
            - title - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞
            - rating - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –Ω–∞ –ö–∏–Ω–æ–ø–æ–∏—Å–∫–µ
            - production_year - –≥–æ–¥ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
            - genre - –∂–∞–Ω—Ä
            - director - —Ä–µ–∂–∏—Å—Å–µ—Ä
            - age_rating - –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥
            - release_date - –¥–∞—Ç–∞ —Ä–µ–ª–∏–∑–∞
            - duration - –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
            - cast - –∞–∫—Ç–µ—Ä—ã
            - budget - –±—é–¥–∂–µ—Ç
            - box_office_usa - –∫–∞—Å—Å–æ–≤—ã–µ —Å–±–æ—Ä—ã –≤ –°–®–ê
            - box_office_world - –∫–∞—Å—Å–æ–≤—ã–µ —Å–±–æ—Ä—ã –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É
            - target: –æ–±—â–∏–π –∫–∞—Å—Å–æ–≤—ã–π —Å–±–æ—Ä (–°–®–ê + –º–∏—Ä)
    """
    )


def eda():
    """
    –†–∞–∑–≤–µ–¥–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
    """
    st.markdown("# –†–∞–∑–≤–µ–¥–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö")
    st.markdown("–ë–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—ã–π EDA –ø–æ —ç—Ç–æ–π —Ç–µ–º–µ - https://github.com/twiracle/film-box-office-prediction")

    with open(CONFIG_PATH, encoding="utf-8") as file:
        config = yaml.load(file, Loader=yaml.FullLoader)

    data = get_data(path=config["preprocessing"]["data_path"])
    clean_data = get_data(path=config["preprocessing"]["clean_data_path"])
    st.write(data.head())

    st.sidebar.markdown("–í—ã–±–µ—Ä–∏—Ç–µ –≥–∏–ø–æ—Ç–µ–∑—É:")

    genre_target = st.sidebar.checkbox(
        "–§–∏–ª—å–º—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∂–∞–Ω—Ä–æ–≤ –≤ —Å—Ä–µ–¥–Ω–µ–º —Å–æ–±–∏—Ä–∞—é—Ç –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥"
    )
    budget_rating_target = st.sidebar.checkbox(
        "–ù–∞ –∫–∞—Å—Å–æ–≤—ã–µ —Å–±–æ—Ä—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –≤–ª–∏—è—é—Ç –±—é–¥–∂–µ—Ç –∏ —Ä–µ–π—Ç–∏–Ω–≥ —Ñ–∏–ª—å–º–∞"
    )
    box_office = st.sidebar.checkbox(
        "–ï—Å–ª–∏ —Ñ–∏–ª—å–º —Å–æ–±–∏—Ä–∞–µ—Ç –º–Ω–æ–≥–æ –¥–µ–Ω–µ–≥ –≤ –º–∏—Ä–æ–≤–æ–º –ø—Ä–æ–∫–∞—Ç–µ, —Ç–æ –æ–±—ã—á–Ω–æ –æ–Ω —Å–æ–±–∏—Ä–∞–µ–º –º–Ω–æ–≥–æ –¥–µ–Ω–µ–≥ –∏ –≤ –°–®–ê"
    )
    age_rating_target = st.sidebar.checkbox(
        "–í–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—Å—Å–æ–≤—ã–µ —Å–±–æ—Ä—ã"
    )
    director_target = st.sidebar.checkbox(
        "–ë–æ–ª–µ–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Ä–µ–∂–∏—Å—Å–µ—Ä—ã —Å–Ω–∏–º–∞—é—Ç —Ñ–∏–ª—å–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–æ—Å—è—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥"
    )
    year_target = st.sidebar.checkbox("–ë–æ–ª–µ–µ –Ω–æ–≤—ã–µ —Ñ–∏–ª—å–º—ã –ø—Ä–∏–Ω–æ—Å—è—Ç –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥")
    cast_target = st.sidebar.checkbox(
        "–ù–∞–ª–∏—á–∏–µ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∞–∫—Ç–µ—Ä–æ–≤ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–±–æ—Ä—ã"
    )

    if genre_target:
        st.markdown(
            """#### –ì–∏–ø–æ—Ç–µ–∑–∞ 1. –§–∏–ª—å–º—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∂–∞–Ω—Ä–æ–≤ –≤ —Å—Ä–µ–¥–Ω–µ–º —Å–æ–±–∏—Ä–∞—é—Ç –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥"""
        )

        st.pyplot(
            bar_plot(
                df=clean_data,
                x_col="main_genre",
                y_col="target",
                title="–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å—Ä–µ–¥–Ω–∏—Ö —Å–±–æ—Ä–æ–≤ –æ—Ç –∂–∞–Ω—Ä–∞",
            )
        )
        st.markdown(
            """
            ##### –í—ã–≤–æ–¥—ã:
            - –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –≤ —Å—Ä–µ–¥–Ω–µ–º –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø—Ä–∏–Ω–æ—Å—è—Ç –∫–∞—Å—Å–æ–≤—ã–µ —Å–æ–±—Ä—ã —Ñ–∏–ª—å–º–æ–≤ —Å —Ç–∞–∫–∏–º–∏ –∂–∞–Ω—Ä–∞–º–∏: –º—É–ª—å—Ç—Ñ–∏–ª—å–º, –∏—Å—Ç–æ—Ä–∏—è –∏ —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞
            - —Ö–æ—Ç—è —É –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö —Ñ–∏–ª—å–º–æ–≤, –≤ –æ—Ç–ª–∏—á–∏–∏ –æ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∂–∞–Ω—Ä–æ–≤, –¥–æ–≤–æ–ª—å–Ω–æ –±–æ–ª—å—à–æ–π —Ä–∞–∑–±—Ä–æ—Å –∑–Ω–∞—á–µ–Ω–∏–π
            - –∫—Ä–æ–º–µ —Ç–æ–≥–æ, –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∂–∞–Ω—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–∏–Ω–æ—Å—è—Ç –Ω–∞–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ –¥–µ–Ω–µ–≥, —á–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ: —Ñ–∏–ª—å–º-–Ω—É–∞—Ä, –¥–æ–∫—É–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π, –º—É–∑—ã–∫–∞ –∏ –∫–æ—Ä–æ—Ç–∫–æ–º–µ—Ç—Ä–∞–∂–∫–∞. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∂–∞–Ω—Ä—ã –±–æ–ª—å—à–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —É–∑–∫–∏–π –∫—Ä—É–≥ –ª—é–¥–µ–π
            - —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –º—É–ª—å—Ç—Ñ–∏–ª—å–º—ã –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–∏–Ω–æ—Å—è—Ç –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥ –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ –Ω–∞ –Ω–∏—Ö –æ–±—ã—á–Ω–æ —Ö–æ–¥—è—Ç –≤—Å–µ–π —Å–µ–º—å–µ–π -> –ø–æ–∫—É–ø–∞—é—Ç –±–æ–ª—å—à–µ –±–∏–ª–µ—Ç–æ–≤
            - –≥–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞—Å—å
            """
        )

    if budget_rating_target:
        st.markdown(
            """#### –ì–∏–ø–æ—Ç–µ–∑–∞ 2. –ù–∞ –∫–∞—Å—Å–æ–≤—ã–µ —Å–±–æ—Ä—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –≤–ª–∏—è—é—Ç –±—é–¥–∂–µ—Ç –∏ —Ä–µ–π—Ç–∏–Ω–≥ —Ñ–∏–ª—å–º–∞"""
        )

        st.pyplot(correlation_plot(df=clean_data))
        st.markdown(
            """
            ##### –í—ã–≤–æ–¥—ã:
            - –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –ø—Ä–∏ –æ–±–æ–∏—Ö –≤–∏–¥–∞—Ö –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Ä–µ–π—Ç–∏–Ω–≥ –Ω–µ —Ç–∞–∫ —Å–∏–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–±–æ—Ä—ã
            - –≤—Å–µ –∂–µ –±–æ–ª—å—à–µ –≤–ª–∏—è–µ—Ç –±—é–¥–∂–µ—Ç (–æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ü–∏—Ä—Å–æ–Ω–∞, —Ö–æ—Ç—è –ø–æ –ü–∏—Ä—Å–æ–Ω—É –≤—Å–µ –∂–µ —Å–≤—è–∑—å –Ω–µ —Ç–∞–∫–∞—è —Å–∏–ª—å–Ω–∞—è)
            - –∫—Ä–æ–º–µ —Ç–æ–≥–æ, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∏–ª—å–º–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—Å—Å–æ–≤—ã–µ —Å–±–æ—Ä—ã –¥–∞–∂–µ –Ω–µ–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ, —á–µ–º —Ä–µ–π—Ç–∏–Ω–≥
            - –Ω–æ –µ—Å–ª–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å—é —Ç–µ–ø–ª–æ–≤—É—é –∫–∞—Ä—Ç—É, —Ç–æ –≤—Å–µ –∂–µ —Å–∏–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–µ—Ç
            - –≥–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞—Å—å –ª–∏—à—å –Ω–∞ –ø–æ–ª–æ–≤–∏–Ω—É
            """
        )

    if box_office:
        st.markdown(
            """#### –ì–∏–ø–æ—Ç–µ–∑–∞ 3. –ï—Å–ª–∏ —Ñ–∏–ª—å–º —Å–æ–±–∏—Ä–∞–µ—Ç –º–Ω–æ–≥–æ –¥–µ–Ω–µ–≥ –≤ –º–∏—Ä–æ–≤–æ–º –ø—Ä–æ–∫–∞—Ç–µ, —Ç–æ –æ–±—ã—á–Ω–æ –æ–Ω —Å–æ–±–∏—Ä–∞–µ–º –º–Ω–æ–≥–æ –¥–µ–Ω–µ–≥ –∏ –≤ –°–®–ê"""
        )

        st.pyplot(
            scatter_plot(
                df=clean_data,
                x_col="box_office_usa",
                y_col="box_office_world",
                hue_col="age_rating",
                hue_order=["0+", "6+", "12+", "16+", "18+", "undefined"],
                title="–°–≤—è–∑—å box_office_usa –∏ box_office_world –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç age_rating",
            )
        )
        st.markdown(
            """
            ##### –í—ã–≤–æ–¥—ã:
            - –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, —Ñ–∏–ª—å–º—ã, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–±—Ä–∞–ª–∏ –º–Ω–æ–≥–æ –≤ –º–∏—Ä–æ–≤–æ–º –ø—Ä–æ–∫–∞—Ç–µ, —Å–æ–±—Ä–∞–ª–∏ –º–Ω–æ–≥–æ –∏ –≤ –°–®–ê
            - –∫—Ä–æ–º–µ —Ç–æ–≥–æ, –µ—Å–ª–∏ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –µ—â–µ –∏ –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥, —Ç–æ —Ñ–∏–ª—å–º—ã 12+ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ç–æ–ø–µ –ø–æ —Å–±–æ—Ä–∞–º, –Ω–æ –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –≤ –æ–¥–Ω–æ–π –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –≥–∏–ø–æ—Ç–µ–∑
            - –≥–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞—Å—å
            """
        )

    if age_rating_target:
        st.markdown("""#### –ì–∏–ø–æ—Ç–µ–∑–∞ 4. –í–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—Å—Å–æ–≤—ã–µ —Å–±–æ—Ä—ã""")

        st.pyplot(
            box_plot(
                df=clean_data,
                y_col="age_rating",
                x_col="target",
                order=["0+", "6+", "12+", "16+", "18+", "undefined"],
                title="–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å age_rating –∏ target",
            )
        )
        st.markdown(
            """
            ##### –í—ã–≤–æ–¥—ã:
            - –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥ –∏ –ø—Ä–∞–≤–¥–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—Å—Å–æ–≤—ã–µ —Å–±–æ—Ä—ã
            - –≤ —Å—Ä–µ–¥–Ω–µ–º –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥ —Å–æ–±–∏—Ä–∞—é—Ç —Ñ–∏–ª—å–º—ã —Å –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ 0+, 6+ –∏ 12+
            - –∫–∞–∫ –±—ã–ª–æ —Å–∫–∞–∑–∞–Ω–æ —Ä–∞–Ω–µ–µ, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ —Ç–∞–∫–∏–µ —Ñ–∏–ª—å–º—ã –æ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –±–æ–ª–µ–µ —à–∏—Ä–æ–∫—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é –∏ –Ω–∞ –Ω–∏—Ö –º–æ–≥—É—Ç —Ö–æ–¥–∏—Ç—å –≤—Å–µ–π —Å–µ–º—å–µ–π
            - –≥–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥–≤–µ—Ä–¥–∏–ª–∞—Å—å
            """
        )

    if director_target:
        st.markdown(
            """#### –ì–∏–ø–æ—Ç–µ–∑–∞ 5. –ë–æ–ª–µ–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Ä–µ–∂–∏—Å—Å–µ—Ä—ã —Å–Ω–∏–º–∞—é—Ç —Ñ–∏–ª—å–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–æ—Å—è—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥"""
        )

        st.pyplot(
            line_plot(
                df=clean_data,
                x_col="director_film_count",
                y_col="target",
                title="–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∂–∏—Å—Å–µ—Ä–∞ –∏ —Å–±–æ—Ä–æ–≤ —Ñ–∏–ª—å–º–∞",
            )
        )
        st.markdown(
            """
            ##### –í—ã–≤–æ–¥—ã:
            - –µ—Å–ª–∏ —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ —á–µ–º –±–æ–ª—å—à–µ —Ñ–∏–ª—å–º–æ–≤ —Å–Ω—è–ª —Ä–µ–∂–∏—Å—Å–µ—Ä, —Ç–µ–º –æ–Ω –∏–∑–≤–µ—Å—Ç–Ω–µ–µ, —Ç–æ –≤—ã—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è —Ç–∞–∫–∞—è –∫–∞—Ä—Ç–∏–Ω–∞
            - –≤ —Ü–µ–ª–æ–º, –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Ä–µ–∂–∏—Å—Å–µ—Ä—ã —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ñ–∏–ª—å–º–æ–≤ —Å–Ω–∏–º–∞—é—Ç —Ñ–∏–ª—å–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–∏–Ω–æ—Å—è—Ç –±–æ–ª—å—à–µ, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Å —Ä–µ–∂–∏—Å—Å–µ—Ä–∞–º–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ –æ–¥–Ω–æ–º—É —Ñ–∏–ª—å–º—É
            - –Ω–æ –µ—Å–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Ä–µ–∂–∏—Å—Å–µ—Ä–∞ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ñ–∏–ª—å–º–æ–≤, —Ç–æ –µ–≥–æ —Ñ–∏–ª—å–º—ã –≤ —Å—Ä–µ–¥–Ω–µ–º —Å–æ–±—Ä–∞–ª–∏ –Ω–µ —Ç–∞–∫ —É–∂ –∏ –º–Ω–æ–≥–æ - –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ –æ–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ —Å —Ä–µ–∂–∏—Å—Å–µ—Ä–∞–º–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ –æ–¥–Ω–æ–º—É —Ñ–∏–ª—å–º—É
            - —Ö–æ—Ç—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ä–µ–∂–∏—Å—Å–µ—Ä–æ–≤ —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ñ–∏–ª—å–º–æ–≤ –≤—Å–µ –∂–µ —Å–æ–±–∏—Ä–∞–ª–∏ –¥–æ–≤–æ–ª—å–Ω–æ –º–Ω–æ–≥–æ –¥–µ–Ω–µ–≥
            - –≥–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞—Å—å, –µ—Å–ª–∏ –æ—Ç—Ç–∞–ª–∫–∏–≤–∞—Ç—å—Å—è –æ—Ç —Ç–∞–∫–æ–≥–æ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç–∏
            """
        )

    if year_target:
        st.markdown("""#### –ì–∏–ø–æ—Ç–µ–∑–∞ 6. –ë–æ–ª–µ–µ –Ω–æ–≤—ã–µ —Ñ–∏–ª—å–º—ã –ø—Ä–∏–Ω–æ—Å—è—Ç –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥""")

        st.pyplot(
            line_plot(
                df=clean_data,
                x_col="production_year",
                y_col="target",
                title="–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å production_year –∏ target",
                mean=True,
            )
        )
        st.markdown(
            """
            ##### –í—ã–≤–æ–¥—ã:
            - –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –æ–±—ã—á–Ω–æ —á–µ–º –Ω–æ–≤–µ–µ —Ñ–∏–ª—å–º, —Ç–µ–º –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥ –æ–Ω –ø—Ä–∏–Ω–µ—Å - —Ñ–∏–ª—å–º—ã –æ—Ç 1995 –≥–æ–¥–∞ –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–∏–Ω–æ—Å—è—Ç –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥, —á–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏
            - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–∞–¥ –±—ã–ª –≤ 2020 - —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –∏–∑-–∑–∞ –ø–∞–Ω–¥–µ–º–∏–∏ –∏ –∫–∞—Ä–∞–Ω—Ç–∏–Ω–æ–≤ –ª—é–¥–∏ –≤—Å–µ –∂–µ —Å–∏–¥–µ–ª–∏ –¥–æ–º–∞, –∞ –Ω–µ —Ö–æ–¥–∏–ª–∏ –≤ –∫–∏–Ω–æ
            - –≥–∏–ø–æ—Ç–µ–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞—Å—å
            """
        )

    if cast_target:
        st.markdown(
            """#### –ì–∏–ø–æ—Ç–µ–∑–∞ 7. –ù–∞–ª–∏—á–∏–µ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∞–∫—Ç–µ—Ä–æ–≤ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–±–æ—Ä—ã"""
        )

        st.pyplot(
            line_plot(
                df=clean_data,
                x_col="actors_fame",
                y_col="target",
                title="–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç–∏ –∞–∫—Ç–µ—Ä–æ–≤ –∏ —Å–±–æ—Ä–æ–≤ —Ñ–∏–ª—å–º–∞",
            )
        )
        st.markdown(
            """
            ##### –í—ã–≤–æ–¥—ã:
            - –µ—Å–ª–∏ —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç—å –∞–∫—Ç–µ—Ä–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å–≤—É–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ñ–∏–ª—å–º–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω–∏ —Å–Ω—è–ª–∏—Å—å, —Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫–∏–µ –≤—ã–≤–æ–¥—ã
            - –∫–∞–∫ –≤–∏–¥–∏–º, —Ñ–∏–ª—å–º—ã —Å –±–æ–ª–µ–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –∞–∫—Ç–µ—Ä–∞–º–∏ –∏ –ø—Ä–∞–≤–¥–∞ –≤ —Å—Ä–µ–¥–Ω–µ–º —Å–æ–±–∏—Ä–∞—é—Ç –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥, —á–µ–º —Ñ–∏–ª—å–º—ã —Å –Ω–µ –æ—á–µ–Ω—å –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –∞–∫—Ç–µ—Ä–∞–º–∏
            - –Ω–æ –≤ —Ç–æ –∂–µ –≤—Ä–µ–º—è, —á–µ–º –±–æ–ª—å—à–µ —Å–ª–∞–≤–∞, —Ç–µ–º –±–æ–ª—å—à–µ —Ä–∞–∑–±—Ä–æ—Å –∑–Ω–∞—á–µ–Ω–∏–π target - —Ñ–∏–ª—å–º –º–æ–∂–µ—Ç —Å–æ–±—Ä–∞—Ç—å –∏ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ, –∏ –æ—á–µ–Ω—å –º–∞–ª–æ
            - –≥–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ –ø–æ–¥—Å—Ç–≤–µ—Ä–¥–∏–ª–∞—Å—å, —Ö–æ—Ç—å –∏ –Ω–µ–∫–∞—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –µ—Å—Ç—å
            """
        )


def training():
    """
    –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏
    """
    st.markdown("# –û–±—É—á–µ–Ω–∏–µ LightGBM")

    with open(CONFIG_PATH) as file:
        config = yaml.load(file, Loader=yaml.FullLoader)

    train_endpoint = config["endpoints"]["training"]

    if st.button("–û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å"):
        train_model(config, train_endpoint)


def prediction_from_file():
    """
    –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –º–æ–¥–µ–ª–∏ –ø–æ —Ñ–∞–π–ª—É —Å –¥–∞–Ω–Ω—ã–º–∏
    """
    st.markdown("# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ —Ñ–∞–π–ª—É —Å –¥–∞–Ω–Ω—ã–º–∏")

    with open(CONFIG_PATH) as file:
        config = yaml.load(file, Loader=yaml.FullLoader)

    endpoint = config["endpoints"]["prediction_file"]

    upload_file = st.file_uploader("", type=["csv"], accept_multiple_files=False)

    if upload_file:
        dataset_csv_df, files = load_data(upload_file, "test")

        if os.path.exists(config["train"]["model_path"]):
            evaluate_from_file(endpoint=endpoint, files=files)

        else:
            st.error("–°–Ω–∞—á–∞–ª–∞ –æ–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å")


def prediction_input():
    """
    –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –º–æ–¥–µ–ª–∏ –ø–æ –≤–≤–µ–¥–µ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º
    """
    st.markdown("# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ –≤–≤–µ–¥–µ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º")
    with open(CONFIG_PATH) as file:
        config = yaml.load(file, Loader=yaml.FullLoader)

    endpoint = config["endpoints"]["prediction_input"]
    unique_data_path = config["preprocessing"]["unique_values_path"]

    # –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
    if os.path.exists(config["train"]["model_path"]):
        evaluate_input(unique_data_path=unique_data_path, endpoint=endpoint)
    else:
        st.error("–°–Ω–∞—á–∞–ª–∞ –æ–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å")


def main():
    """
    –°–±–æ—Ä–∫–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
    """
    pages_names_dict = {
        "–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞": main_page,
        "–†–∞–∑–≤–µ–¥–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö": eda,
        "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏": training,
        "–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø–æ —Ñ–∞–π–ª—É": prediction_from_file,
        "–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø–æ –≤–≤–æ–¥—É": prediction_input,
    }

    selected_page = st.sidebar.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É", pages_names_dict.keys())
    pages_names_dict[selected_page]()


if __name__ == "__main__":
    main()
